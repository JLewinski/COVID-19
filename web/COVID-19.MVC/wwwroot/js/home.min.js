var colors=["rgb(0,128,0)","rgb(141,182,0)","rgb(0,255,255)","rgb(253,238,0)","rgb(0,127,255)","rgb(0,0,255)","rgb(0,221,221)","rgb(242,101,34)","rgb(12,35,64)","rgb(150,0,24)","rgb(150,75,0)","rgb(0,71,171)","rgb(255,40,0)","rgb(255,0,79)","rgb(255,223,0)","rgb(0,255,0)","rgb(128,0,0)","rgb(0,250,154)","rgb(255,0,0)","rgb(255,103,0)"],dates;$(()=>{function n(n,t,i,r,u){var f=document.getElementById(n);return u||(u="bar"),new Chart(f,{type:u,data:{labels:t,datasets:i},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}]},title:{display:!0,text:r}}})}function i(t){var u=1*t.offset,f=1*t.range,i=[],r=[],e=0,o,s;for(t.confirmedData.forEach((n,o)=>{var h=0,c=0,s,l;if(!(f+u>=t.deathData.length)){for(s=0;s<f;s++)h+=t.confirmedData[o+s],c+=t.deathData[o+s+u];l=h?c/h*100:c*100;(l||i.length)&&(i[e]=l,r[e++]=dates[o+u+f/2],r[e++]||(r[e++]=dates[o+u+f/2-.5]))}}),o=i.pop();!o&&i.length;)r.pop(),o=i.pop();i.push(o);t.percentFatalChart?(t.percentFatalChart.data.labels=r,t.percentFatalChart.data.datasets[0].data=i,t.percentFatalChart.update()):(s={data:i,backgroundColor:colors[0],borderColor:colors[0]},t.percentFatalChart=n("percentFatalChart"+t.groupIndex,r,[s],"Death Percentage"),t.percentFatalChart.options.scales.yAxes[0].ticks.max=25,t.percentFatalChart.options.scales.yAxes[0].scaleLabel.labelString="Percent Fatal",t.percentFatalChart.options.scales.yAxes[0].scaleLabel.display=!0,t.percentFatalChart.update())}function t(t){$.getJSON(stateDataUrl+"?state="+t.selectedState+"&country="+t.selectedCountry.name).done(r=>{var u,o,s,f,e,h;if(!r.success){console.error("State: "+r.errorMessage);return}dates=r.dates;t.confirmedData=r.confirmedCases.data;u=t.selectedState+" New Confirmed Cases";t.confirmedChart?(t.confirmedChart.data.datasets[0].data=t.confirmedData,t.confirmedChart.options.title.text=u,t.confirmedChart.update()):(o={data:t.confirmedData,backgroundColor:colors[7],borderColor:colors[7]},t.confirmedChart=n("stateConfirmedChart"+t.groupIndex,r.dates,[o],u));t.deathData=r.deaths.data;u=t.selectedState+" New Deaths";t.deathChart?(t.deathChart.data.datasets[0].data=t.deathData,t.deathChart.options.title.text=u,t.deathChart.update()):(s={data:t.deathData,backgroundColor:colors[8],borderColor:colors[8]},t.deathChart=n("stateDeathsChart"+t.groupIndex,r.dates,[s],u));f=[];e=0;r.confirmedCases.data.forEach((n,t)=>{e+=n,f[t]=e/r.deaths.population*100});u=t.selectedState+" Percent of Population That Has Been (Confirmed) Infected";t.percentInfectedChart?(t.percentInfectedChart.data.datasets[0].data=f,t.percentInfectedChart.options.title.text=u,t.percentInfectedChart.update()):(h=[{data:f,backgroundColor:colors[14],borderColor:colors[14]}],t.percentInfectedChart=n("percentInfectedChart"+t.groupIndex,r.dates,h,u,"line"));i(t)})}$.getJSON(countryListUrl).done(n=>{if(!n.success){console.error("Country: "+n.errorMessage);return}self={countries:n.countries,selectedCountry:{},chartGroups:[{groupIndex:0,selectedCountry:{},selectedState:{},offset:15,range:5},{groupIndex:1,selectedCountry:{},selectedState:{},offset:15,range:5}],updateCharts:t,updateFatality:i};ko.track(self);ko.track(self.chartGroups[0]);ko.track(self.chartGroups[1]);self.countries.forEach(n=>{n.name=="US"&&(self.chartGroups[0].selectedCountry=n)});self.countries.forEach(n=>{n.name=="US"&&(self.chartGroups[1].selectedCountry=n)});ko.applyBindings(self);self.chartGroups[0].selectedState="Alabama";t(self.chartGroups[0]);self.chartGroups[1].selectedState="Georgia";t(self.chartGroups[1])})});