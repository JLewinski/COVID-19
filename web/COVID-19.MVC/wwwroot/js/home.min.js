var colors=["rgb(0,128,0)","rgb(141,182,0)","rgb(0,255,255)","rgb(253,238,0)","rgb(0,127,255)","rgb(0,0,255)","rgb(0,221,221)","rgb(242,101,34)","rgb(12,35,64)","rgb(150,0,24)","rgb(150,75,0)","rgb(0,71,171)","rgb(255,40,0)","rgb(255,0,79)","rgb(255,223,0)","rgb(0,255,0)","rgb(128,0,0)","rgb(0,250,154)","rgb(255,0,0)","rgb(255,103,0)"],dates;$(()=>{function n(n,t,i,r,u){var f=document.getElementById(n);return u||(u="bar"),new Chart(f,{type:u,data:{labels:t,datasets:i},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}]},title:{display:!0,text:r}}})}function t(n,t,i){n.data.datasets[0].data=t;n.options.title.text=i;n.update()}function r(t){var f=1*t.offset,e=1*t.range,i=[],r=[],u=0,o,s;for(t.confirmedData.forEach((n,o)=>{var h=0,c=0,s,l;if(!(e+f>=t.deathData.length)){for(s=0;s<e;s++)h+=t.confirmedData[o+s],c+=t.deathData[o+s+f];l=h?c/h*100:c*100;(l||i.length)&&(i[u]=l,r[u]=dates[o+f+e/2],r[u]||(r[u]=dates[o+f+e/2-.5]),u++)}}),o=i.pop();!o&&i.length;)r.pop(),o=i.pop();i.push(o);t.percentFatalChart?(t.percentFatalChart.data.labels=r,t.percentFatalChart.data.datasets[0].data=i,t.percentFatalChart.update()):(s={data:i,backgroundColor:colors[0],borderColor:colors[0]},t.percentFatalChart=n("percentFatalChart"+t.groupIndex,r,[s],"Death Percentage"),t.percentFatalChart.options.scales.yAxes[0].ticks.max=25,t.percentFatalChart.options.scales.yAxes[0].scaleLabel.labelString="Percent Fatal",t.percentFatalChart.options.scales.yAxes[0].scaleLabel.display=!0,t.percentFatalChart.update())}function i(i){$.getJSON(stateDataUrl+"?state="+i.selectedState+"&country="+i.selectedCountry.name).done(u=>{var f,s,h,e,o,c;if(!u.success){console.error("State: "+u.errorMessage);return}dates=u.dates;i.confirmedData=u.confirmedCases.data;f=i.selectedState+" New Confirmed Cases";i.confirmedChart?t(i.confirmedChart,i.confirmedData,f):(s={data:i.confirmedData,backgroundColor:colors[7],borderColor:colors[7]},i.confirmedChart=n("stateConfirmedChart"+i.groupIndex,u.dates,[s],f));i.deathData=u.deaths.data;f=i.selectedState+" New Deaths";i.deathChart?t(i.deathChart,i.deathData,f):(h={data:i.deathData,backgroundColor:colors[8],borderColor:colors[8]},i.deathChart=n("stateDeathsChart"+i.groupIndex,u.dates,[h],f));e=[];o=0;u.confirmedCases.data.forEach((n,t)=>{o+=n,e[t]=o/u.deaths.population*100});f=i.selectedState+" Percent of Population That Has Been (Confirmed) Infected";i.percentInfectedChart?t(i.percentInfectedChart,e,f):(c=[{data:e,backgroundColor:colors[14],borderColor:colors[14]}],i.percentInfectedChart=n("percentInfectedChart"+i.groupIndex,u.dates,c,f,"line"));r(i)})}$.getJSON(countryListUrl).done(n=>{if(!n.success){console.error("Country: "+n.errorMessage);return}self={countries:n.countries,selectedCountry:{},chartGroups:[{groupIndex:0,selectedCountry:{},selectedState:{},offset:15,range:5},{groupIndex:1,selectedCountry:{},selectedState:{},offset:15,range:5}],updateCharts:i,updateFatality:r};ko.track(self);ko.track(self.chartGroups[0]);ko.track(self.chartGroups[1]);self.countries.forEach(n=>{n.name=="US"&&(self.chartGroups[0].selectedCountry=n)});self.countries.forEach(n=>{n.name=="US"&&(self.chartGroups[1].selectedCountry=n)});ko.applyBindings(self);self.chartGroups[0].selectedState="Alabama";i(self.chartGroups[0]);self.chartGroups[1].selectedState="Georgia";i(self.chartGroups[1])})});